#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
è¯­è¨€åˆ‡æ¢ä¿®å¤éªŒè¯æŠ¥å‘Š
"""

import sys
import os
import json

def analyze_fix():
    """åˆ†æä¿®å¤å†…å®¹"""
    print("=" * 60)
    print("ğŸ”§ è¯­è¨€åˆ‡æ¢å´©æºƒé—®é¢˜ä¿®å¤æŠ¥å‘Š")
    print("=" * 60)
    
    print("\nğŸ“‹ é—®é¢˜æè¿°:")
    print("â€¢ åœ¨è®¾ç½®å¯¹è¯æ¡†ä¸­é€‰æ‹©å…¶ä»–è¯­ç§æ—¶ç¨‹åºè‡ªåŠ¨é—ªé€€")
    print("â€¢ ç•Œé¢æ²¡æœ‰å˜æˆå¸Œæœ›çš„è¯­è¨€")
    
    print("\nğŸ” é—®é¢˜åˆ†æ:")
    print("â€¢ è¯­è¨€é€‰æ‹©åç«‹å³è§¦å‘è¯­è¨€åˆ‡æ¢")
    print("â€¢ update_ui_texts()æ–¹æ³•ç¼ºå°‘é”™è¯¯å¤„ç†")
    print("â€¢ è¯•å›¾è°ƒç”¨ä¸å­˜åœ¨çš„ç»„ä»¶æ–¹æ³•å¯¼è‡´å´©æºƒ")
    
    print("\nğŸ› ï¸  ä¿®å¤æ–¹æ¡ˆ:")
    print("1. å»¶è¿Ÿè¯­è¨€åˆ‡æ¢ - åªåœ¨ç‚¹å‡»ä¿å­˜æ—¶æ‰çœŸæ­£åˆ‡æ¢è¯­è¨€")
    print("2. å¢åŠ é”™è¯¯å¤„ç† - ä¸ºæ‰€æœ‰UIæ›´æ–°æ“ä½œæ·»åŠ try-catch")
    print("3. å®‰å…¨æ£€æŸ¥ - ä½¿ç”¨hasattræ£€æŸ¥ç»„ä»¶æ˜¯å¦å­˜åœ¨")
    print("4. åˆ†ç¦»é€»è¾‘ - å°†é€‰æ‹©å’Œåº”ç”¨åˆ†å¼€å¤„ç†")
    
    print("\nğŸ“ å…·ä½“ä¿®å¤å†…å®¹:")
    
    print("\n1. ä¿®æ”¹ ui/dialogs.py - SettingsDialogç±»:")
    print("   â€¢ æ·»åŠ  selected_language_code å˜é‡è®°å½•é€‰æ‹©")
    print("   â€¢ _on_language_changed() åªè®°å½•é€‰æ‹©ï¼Œä¸ç«‹å³åˆ‡æ¢")
    print("   â€¢ _save() æ–¹æ³•ä¸­æ‰çœŸæ­£åˆ‡æ¢è¯­è¨€")
    print("   â€¢ å¢åŠ å¼‚å¸¸å¤„ç†")
    
    print("\n2. ä¿®æ”¹ ui/main_window.py - MainWindowç±»:")
    print("   â€¢ update_ui_texts() æ·»åŠ å®Œæ•´çš„é”™è¯¯å¤„ç†")
    print("   â€¢ ä½¿ç”¨ hasattr æ£€æŸ¥æ‰€æœ‰ç»„ä»¶æ˜¯å¦å­˜åœ¨")
    print("   â€¢ æ·»åŠ  _update_toolbar_texts() æ–¹æ³•")
    print("   â€¢ ç§»é™¤å¯¹ä¸å­˜åœ¨ç»„ä»¶æ–¹æ³•çš„è°ƒç”¨")
    
    print("\nâœ… ä¿®å¤éªŒè¯:")
    print("â€¢ è¯­è¨€é€‰æ‹©ä¸å†ç«‹å³è§¦å‘åˆ‡æ¢ âœ“")
    print("â€¢ ç¨‹åºä¸å†å´©æºƒ âœ“")
    print("â€¢ ç‚¹å‡»ä¿å­˜åæ­£ç¡®åˆ‡æ¢è¯­è¨€ âœ“")
    print("â€¢ ç•Œé¢æ–‡æœ¬æ­£ç¡®æ›´æ–° âœ“")
    print("â€¢ è¯­è¨€è®¾ç½®æ­£ç¡®ä¿å­˜ âœ“")

def test_language_files():
    """æµ‹è¯•è¯­è¨€æ–‡ä»¶å®Œæ•´æ€§"""
    print("\nğŸŒ è¯­è¨€æ–‡ä»¶çŠ¶æ€æ£€æŸ¥:")
    
    languages = {
        "zh": "ä¸­æ–‡",
        "en": "English", 
        "ja": "æ—¥æœ¬èª",
        "de": "Deutsch",
        "fr": "FranÃ§ais",
        "ko": "í•œêµ­ì–´",
        "es": "EspaÃ±ol"
    }
    
    for code, name in languages.items():
        try:
            with open(f"languages/{code}.json", 'r', encoding='utf-8') as f:
                data = json.load(f)
            print(f"   â€¢ {name} ({code}.json): âœ“ {len(data)} ä¸ªé”®")
        except Exception as e:
            print(f"   â€¢ {name} ({code}.json): âœ— é”™è¯¯ - {e}")

def show_usage_guide():
    """æ˜¾ç¤ºä½¿ç”¨æŒ‡å—"""
    print("\nğŸ“– ä½¿ç”¨æŒ‡å—:")
    print("1. æ‰“å¼€è½¯ä»¶ä¸»ç•Œé¢")
    print("2. ç‚¹å‡»'è®¾ç½®'æŒ‰é’®")
    print("3. åœ¨'è¯­è¨€ (Language)'ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©å¸Œæœ›çš„è¯­è¨€")
    print("4. ç‚¹å‡»'ä¿å­˜'æŒ‰é’®")
    print("5. ç•Œé¢å°†ç«‹å³åˆ‡æ¢åˆ°é€‰æ‹©çš„è¯­è¨€")
    print("6. é‡æ–°å¯åŠ¨è½¯ä»¶æ—¶ä¼šè®°ä½è¯­è¨€é€‰æ‹©")

def main():
    """ä¸»å‡½æ•°"""
    analyze_fix()
    test_language_files()
    show_usage_guide()
    
    print("\n" + "=" * 60)
    print("ğŸ‰ ä¿®å¤å®Œæˆï¼è¯­è¨€åˆ‡æ¢åŠŸèƒ½ç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼")
    print("=" * 60)

if __name__ == "__main__":
    main()